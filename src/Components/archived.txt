import React from 'react'
import styles from "./testscreen.css"
import Timer from './timer'
import Highlight from './getHighlight'
import ButtonComponent from './button'
import ProgressNum from './progressNum'
import {Progress} from 'reactstrap'
import MathComponent from './MathComponent'
export default class TestScreen extends React.Component {

    constructor(props) {
        super(props);
        this.state = {
            isTestSubmitted: false,
            currentSection: 0,
            currentSubject:0, 
            NumeberOfCorrectAnswersOfEachSubject: [], 
            readingScore: 0, 
            writingScore: 0, 
            mathScore: 0,
            mathNoCal:0, 
            mathWithCal:0, 
            correctReading: 0, 
            correctWriting: 0,
            correctmathNoCal:0, 
            correctmathWithCal:0, 
            verbal: 0, 
            total:0, 
            sections: [
                {
                    id:1, 
                    sectionType:  'reading', 
                    title: "This passage is from James Joyce, The Dubliners originally published in 1914",
                    passage: '1914 Mr Holohan, assistant secretary of the Eire Abu Society, had been walking up and down Dublin for nearly a month, with his hands and pockets full of dirty pieces of paper, arranging about the series of concerts. He had a game leg and for this his friends called him Hoppy Holohan. He walked up and down constantly, stood by the hour at street corners arguing the point and made notes; but in the end it was Mrs Kearney who arranged every Miss Devlin had become Mrs Kearney out of spite. She had been educated in a', 
                    IsLastSectionType: false, 
                    questions: [
                        {
                            id: 1,
                            question: 
                            "1.1 As presented in the passage, Mr. Kearney is best described as",  
                            choices: [
                                {
                                    opt: 'A',
                                    id: 1, 
                                    text:"independent and strong willed.", 
                                    check: false, 
                                },
                                {
                                    opt: 'B',
                                    id:2, 
                                    text:"paternal and affectionate.",  
                                    check:false, 
                                },
                                {
                                    opt: 'C',
                                    id:3, 
                                    text: "serious and family oriented.",  
                                    check:true, 
                                },
                                {
                                    opt: 'D',
                                    id:4, 
                                    text: "boring and simple minded.",  
                                    check:false, 
                                } 
                            ],
                            selectedChoice: '',
                       
                        },
                        {
                            id: 2,
                            question: 
                            "1.2 As presented in the passage, Mr. Kearney is best described as",  
                            choices: [
                                {
                                    opt: 'A',
                                    id: 1, 
                                    text:"2independent and strong willed.", 
                                    check: false, 
        
                                },
                                {
                                    opt: 'B',
                                    id:2, 
                                    text:"2paternal and affectionate.",  
                                    check: false, 
        
                                },
                                {
                                    opt: 'C',
                                    id:3, 
                                    text: "2serious and family oriented.",  
                                    check: false, 
        
                                },
                                {
                                    opt: 'D',
                                    id:4, 
                                    text: "2boring and simple minded.",  
                                    check: true, 
        
                                } 
                            ],
                            selectedChoice: '',
                       
                        },
                    ] 
                }, 

                {
                    id:2, 
                            sectionType: 'reading', 
                            IsLastSectionType: true, 
                            title: 'Questions 11-20 are based on the following passage and supplementary material.', 
                            passage: 'The central aim of the current study was to eschew the experimental context traditionally used to study over-imitation, in order to determine whether visibly causally irrelevant actions would be copied in a naturalistic context in which the participants were unaware that they were taking part in an experiment, and therefore free from any social pressures. In order to achieve such a real-world context our child and adult participants viewed an individual, whom they believed to be another zoo visitor, retrieve a reward from inside a transparent puzzle box, using an action sequence which contained elements that were readily discernible as causally irrelevant. The task demonstration involved the model performing a sequence of causally',
                            questions: [
                                {
                                    id: 3,
                                    question: 
                                    "2.1 As presented in the passage, Mr. Kearney is best described as",  
                                    choices: [
                                        {
                                            opt: 'A',
                                            id: 1, 
                                            text:"independent and strong willed.", 
                                            check: false, 
                                        },
                                        {
                                            opt: 'B',
                                            id:2, 
                                            text:"paternal and affectionate.",  
                                            check:false, 
                                        },
                                        {
                                            opt: 'C',
                                            id:3, 
                                            text: "serious and family oriented.",  
                                            check:true, 
                                        },
                                        {
                                            opt: 'D',
                                            id:4, 
                                            text: "boring and simple minded.",  
                                            check:false, 
                                        } 
                                    ],
                                    selectedChoice: '',
                            
                                },
                                {
                                    id: 4,
                                    question: 
                                    "2.2 As presented in the passage, Mr. Kearney is best described as",  
                                    choices: [
                                        {
                                            opt: 'A',
                                            id: 1, 
                                            text:"2independent and strong willed.", 
                                            check: false, 
                
                                        },
                                        {
                                            opt: 'B',
                                            id:2, 
                                            text:"2paternal and affectionate.",  
                                            check: false, 
                
                                        },
                                        {
                                            opt: 'C',
                                            id:3, 
                                            text: "2serious and family oriented.",  
                                            check: false, 
                
                                        },
                                        {
                                            opt: 'D',
                                            id:4, 
                                            text: "2boring and simple minded.",  
                                            check: true, 
                
                                        } 
                                    ],
                                    selectedChoice: '',
                                }
                            ],
                }, 
                
                {
                    id:3, 
                            sectionType: 'writing', 
                            IsLastSectionType: false, 
                            title:' Violet Wood Sorrel Plant', 
                            passage: 'only attraction possessed by this charming little plant. As a family, the wood-sorrels have great interest for botanists since Darwin devoted such         1 long study to their power of movement. and many other scientists have described the several forms assumed by perfect flowers of the same',
                            questions: [
                                {
                                    id: 1,
                                    question: 
                                    "1.1 As presented in the passage, Mr. Kearney is best described as",  
                                    choices: [
                                        {
                                            opt: 'A',
                                            id: 1, 
                                            text:"independent and strong willed.", 
                                            check: false, 
                                        },
                                        {
                                            opt: 'B',
                                            id:2, 
                                            text:"paternal and affectionate.",  
                                            check:false, 
                                        },
                                        {
                                            opt: 'C',
                                            id:3, 
                                            text: "serious and family oriented.",  
                                            check:true, 
                                        },
                                        {
                                            opt: 'D',
                                            id:4, 
                                            text: "boring and simple minded.",  
                                            check:false, 
                                        } 
                                    ],
                                    selectedChoice: '',
                               
                                },
                                {
                                    id: 2,
                                    question: 
                                    "1.2 As presented in the passage, Mr. Kearney is best described as",  
                                    choices: [
                                        {
                                            opt: 'A',
                                            id: 1, 
                                            text:"2independent and strong willed.", 
                                            check: false, 
                
                                        },
                                        {
                                            opt: 'B',
                                            id:2, 
                                            text:"2paternal and affectionate.",  
                                            check: false, 
                
                                        },
                                        {
                                            opt: 'C',
                                            id:3, 
                                            text: "2serious and family oriented.",  
                                            check: false, 
                
                                        },
                                        {
                                            opt: 'D',
                                            id:4, 
                                            text: "2boring and simple minded.",  
                                            check: true, 
                
                                        } 
                                    ],
                                    selectedChoice: '',
                               
                                },
                            ]
                }, 

                {
                    id:4, 
                            sectionType: 'writing', 
                            IsLastSectionType: true, 
                            title:' Violet Wood Sorrel Plant 2', 

                            passage: 'The first Ohio stories are part of the common story of the wonderful Ice Age, when a frozen deluge pushed down from the north and covered a vast part of the earthâ€™s surface with slowly moving glaciers',
                            questions: [
                                {
                                    id: 3,
                                    question: 
                                    "2.1 As presented in the passage, Mr. Kearney is best described as",  
                                    choices: [
                                        {
                                            opt: 'A',
                                            id: 1, 
                                            text:"independent and strong willed.", 
                                            check: false, 
                                        },
                                        {
                                            opt: 'B',
                                            id:2, 
                                            text:"paternal and affectionate.",  
                                            check:false, 
                                        },
                                        {
                                            opt: 'C',
                                            id:3, 
                                            text: "serious and family oriented.",  
                                            check:true, 
                                        },
                                        {
                                            opt: 'D',
                                            id:4, 
                                            text: "boring and simple minded.",  
                                            check:false, 
                                        } 
                                    ],
                                    selectedChoice: '',
                            
                                },
                                {
                                    id: 4,
                                    question: 
                                    "2.2 As presented in the passage, Mr. Kearney is best described as",  
                                    choices: [
                                        {
                                            opt: 'A',
                                            id: 1, 
                                            text:"2independent and strong willed.", 
                                            check: false, 
                
                                        },
                                        {
                                            opt: 'B',
                                            id:2, 
                                            text:"2paternal and affectionate.",  
                                            check: false, 
                
                                        },
                                        {
                                            opt: 'C',
                                            id:3, 
                                            text: "2serious and family oriented.",  
                                            check: false, 
                
                                        },
                                        {
                                            opt: 'D',
                                            id:4, 
                                            text: "2boring and simple minded.",  
                                            check: true, 
                
                                        } 
                                    ],
                                    selectedChoice: '',
                                }
                            ]
                }, 
                
                {
                    id:5, 
                            sectionType: 'mathNoCal', 
                            IsLastSectionType: true, 

                            questions: [
                                {
                                    id: 1,
                                    question: 
                                    "1.1 As presented in the passage, Mr. Kearney is best described as",  
                                    choices: [
                                        {
                                            opt: 'A',
                                            id: 1, 
                                            text:"independent and strong willed.", 
                                            check: false, 
                                        },
                                        {
                                            opt: 'B',
                                            id:2, 
                                            text:"paternal and affectionate.",  
                                            check:false, 
                                        },
                                        {
                                            opt: 'C',
                                            id:3, 
                                            text: "serious and family oriented.",  
                                            check:true, 
                                        },
                                        {
                                            opt: 'D',
                                            id:4, 
                                            text: "boring and simple minded.",  
                                            check:false, 
                                        } 
                                    ],
                                    selectedChoice: '',
                               
                                },
                                {
                                    id: 2,
                                    question: 
                                    "1.2 As presented in the passage, Mr. Kearney is best described as",  
                                    choices: [
                                        {
                                            opt: 'A',
                                            id: 1, 
                                            text:"2independent and strong willed.", 
                                            check: false, 
                
                                        },
                                        {
                                            opt: 'B',
                                            id:2, 
                                            text:"2paternal and affectionate.",  
                                            check: false, 
                
                                        },
                                        {
                                            opt: 'C',
                                            id:3, 
                                            text: "2serious and family oriented.",  
                                            check: false, 
                
                                        },
                                        {
                                            opt: 'D',
                                            id:4, 
                                            text: "2boring and simple minded.",  
                                            check: true, 
                
                                        } 
                                    ],
                                    selectedChoice: '',
                               
                                },
                            ], 
                            fillInQuestions: [
                                {
                                    id:1, 
                                    question: "Juan purchased an antique that had a value of $200 at the time of purchase. Each year, the value of the antique is estimated to increase 10% over its value the previous year. The estimated value of the antique, in dollars, 2 years after purchase can be represented by the expression 200a, where a is a constant. What is the value of a ?",
                                    text: "1.21", 
                                    check: true, 
                                }, 
                                {
                                    id:2, 
                                    question: "Juan purchased an antique that had a value of $200 at the time of purchase. Each year, the value of the antique is estimated to increase 10% over its value the previous year. The estimated value of the antique, in dollars, 2 years after purchase can be represented by the expression 200a, where a is a constant. What is the value of a ?",
                                    text: "1.21", 
                                    check: true, 
                                }
                            ]
                }, 

                {
                    id:6,
                    sectionType: 'mathWithCal', 
                    IsLastSectionType: true, 
                    questions: [
                        {
                            id: 1,
                            question: 
                            "1.1 As presented in the passage, Mr. Kearney is best described as",  
                            choices: [
                                {
                                    opt: 'A',
                                    id: 1, 
                                    text:"independent and strong willed.", 
                                    check: false, 
                                },
                                {
                                    opt: 'B',
                                    id:2, 
                                    text:"paternal and affectionate.",  
                                    check:false, 
                                },
                                {
                                    opt: 'C',
                                    id:3, 
                                    text: "serious and family oriented.",  
                                    check:true, 
                                },
                                {
                                    opt: 'D',
                                    id:4, 
                                    text: "boring and simple minded.",  
                                    check:false, 
                                } 
                            ], 
                            selectedChoice: '',
                        }, 
                        {
                            id: 2,
                            question: 
                            "1.2 As presented in the passage, Mr. Kearney is best described as",  
                            choices: [
                                {
                                    opt: 'A',
                                    id: 1, 
                                    text:"2independent and strong willed.", 
                                    check: false, 
        
                                },
                                {
                                    opt: 'B',
                                    id:2, 
                                    text:"2paternal and affectionate.",  
                                    check: false, 
        
                                },
                                {
                                    opt: 'C',
                                    id:3, 
                                    text: "2serious and family oriented.",  
                                    check: false, 
        
                                },
                                {
                                    opt: 'D',
                                    id:4, 
                                    text: "2boring and simple minded.",  
                                    check: true, 
        
                                } 
                            ],
                            selectedChoice: '',
                        }
                    ], 
                    fillInQuestions: [
                        {
                            id:1, 
                            question: "Juan purchased an antique that had a value of $200 at the time of purchase. Each year, the value of the antique is estimated to increase 10% over its value the previous year. The estimated value of the antique, in dollars, 2 years after purchase can be represented by the expression 200a, where a is a constant. What is the value of a ?",
                            text: "1.21", 
                            check: true, 
                        }, 
                        {
                            id:2, 
                            question: "Juan purchased an antique that had a value of $200 at the time of purchase. Each year, the value of the antique is estimated to increase 10% over its value the previous year. The estimated value of the antique, in dollars, 2 years after purchase can be represented by the expression 200a, where a is a constant. What is the value of a ?",
                            text: "1.21", 
                            check: true, 
                        }
                    ]

                }, 
                
            ],
           
        };
 }
    renderAllQuestions() {
        const {sections, currentSection} = this.state; 
        const section = sections[currentSection];

        if (section.sectionType === 'reading' || section.sectionType === 'writing' ) {
            return (
                <div>
                    
                    <h4> SECTION {section.sectionType}</h4>
                    {

                        section.questions.map((subquestion, index2) => {
                            return (
                                    <ButtonComponent
                                    key={subquestion.id}
                                    onClick={(selectedId) => {
                                        subquestion.selectedChoice = subquestion.selectedChoice != selectedId? selectedId : ''; // update the selectedChoice of this question with the clicked choice
                                        this.setState({
                                            questions: [
                                                ...section.questions.slice(0, index2), // questions array before updated question - stay exactly the same
                                                subquestion, // updated question - it's updated with the selectedChoice
                                                ...section.questions.slice(index2+1, section.questions.length), // questions array after updated question - stays exactly the same
                                            ]
                                        });
                                    }}
                                    selectedChoice={subquestion.selectedChoice}
                                    question={subquestion.question}
                                    choices={subquestion.choices}
                            />
                            )

                        })
                    }
                </div>
            )                
        }
        else {
            return (
                <div>
                    
                    <h4> SECTION {section.sectionType}</h4>
                    {

                        section.questions.map((subquestion, index2) => {
                            return (
                                <ButtonComponent
                                key={subquestion.id}
                                onClick={(selectedId) => {
                                    subquestion.selectedChoice = subquestion.selectedChoice != selectedId? selectedId : ''; // update the selectedChoice of this question with the clicked choice
                                    this.setState({
                                        questions: [
                                            ...section.questions.slice(0, index2), // questions array before updated question - stay exactly the same
                                            subquestion, // updated question - it's updated with the selectedChoice
                                            ...section.questions.slice(index2+1, section.questions.length), // questions array after updated question - stays exactly the same
                                        ]
                                    });
                                }}
                                selectedChoice={subquestion.selectedChoice}
                                question={subquestion.question}
                                choices={subquestion.choices}
                                />           
                            )
                            
                            
                        
                        }), 

                        section.fillInQuestions.map((subfillInQuestion)=> {
                            return (
                                <MathComponent
                                key = {subfillInQuestion.id}
                                question={subfillInQuestion.question}
                                />
                            )
                        })

                    }
                    
                </div>
            )  
        }

    }
    IsLastElementOfSectionsArray() {
        const {currentSection, sections} = this.state;
        /*  if id of the current subject = the size of the subjects then return true */
        return (currentSection === sections.length-1);
   }

    IsLastSection() {
        const {
            currentSection,
            sections,
        } = this.state;
        const section = sections[currentSection];
        if (section.IsLastSectionType === true) {
            return section.id; 
        }
    }
   // checkingFillInQuestions() {
//
  //  }
    addPassageOrNot() {
        const {
            currentSection,
            sections,
        } = this.state;
        const section = sections[currentSection];
        if (section.sectionType === 'reading' ||section.sectionType === 'writing' ) {
            return (

                <div className="passageSection">
                <div className="passagename">
                <b>{section.title}</b>
                </div>
                <Highlight passage = {section.passage}/>
                </div>
            ) 
        }        
    }

    renderRightButton() {
        const {
            currentSection,
            sections,
        } = this.state;
        const section = sections[currentSection];
        let buttonText = 'Next'; 
        if (this.IsLastSection() && section.sectionType === 'reading') {
            buttonText = 'Go to Writing and Language'; 
        }
        else if (this.IsLastSection() && section.sectionType === 'writing') {
            buttonText = 'Go to Math (No Calculators)'; 
        }
        else if (this.IsLastSection() && section.sectionType === 'mathNoCal') {
            buttonText = 'Go to Math (With Calculators)'; 
        }
        else if (this.IsLastSection() && section.sectionType === 'mathWithCal') {
            buttonText = 'Submit'; 
        }

        return (<button className="btn btn-primary m-2" onClick={() => this.checkingAllQuestions()}>{buttonText}</button>);

    }
    
    checkingAllQuestions() {
        const {currentSection, sections, correctWriting, correctmathNoCal, correctmathWithCal} = this.state; 

            if  (this.IsLastElementOfSectionsArray() && this.IsLastSection()) {
                sections.map(section => {
                    section.questions.map((question) => {
                        const correctAnswer = question.choices.find((choice) => choice.check === true);
                        if (section.sectionType === 'reading' ) {
                            if(correctAnswer.id === question.selectedChoice) { 
                                this.setState(currentState => {
                                    return {
                                        correctReading: currentState.correctReading + 1
                                    }
                                }, () => this.CalculateScores());
                            }
                        } //TODO: else  if(section.sectionType === 'writing' ) { Exactly the same logic as reading but for the others}
                    });
        
                    if(section.sectionType === 'writing' ) {
                        section.questions.map((question) => {
                            const correctAnswer = question.choices.find((choice) => choice.check === true);
                            if(correctAnswer.id === question.selectedChoice) { 
                                this.setState(currentState => {
                                    return {
                                        correctWriting: currentState.correctWriting + 1
                                    }
                                }, () => this.CalculateScores()); 
                            }
                        })
                    }
                    else if(section.sectionType === 'mathNoCal' ) {
                        section.questions.map((question) => {
                            const correctAnswer = question.choices.find((choice) => choice.check === true);
                            if(correctAnswer.id === question.selectedChoice) { 
                                this.setState({
                                    correctmathNoCal: correctmathNoCal+1
                                })
                            }
                        })
                    }
                    else if(section.sectionType === 'mathWithCal' ) {
                        section.questions.map((question) => {
                            const correctAnswer = question.choices.find((choice) => choice.check === true);
                            if(correctAnswer.id === question.selectedChoice) { 
                                this.setState({
                                    correctmathWithCal: correctmathWithCal+1
                                })
                            }
                        })
                    }
                });


            } else {
                this.setState({
                    currentSection: currentSection + 1 
                })
            }
    }

    CalculateScores() {

        const {isTestSubmitted, readingScore, writingScore, currentSection, mathScore,mathNoCal,mathWithCal, sections, correctReading, correctWriting, correctmathNoCal, correctmathWithCal} = this.state; 

        //READING
        if (correctReading >= 0 && correctReading <= 3) {
            this.setState({
                readingScore: 100
            }) 
        } 
        else if ( correctReading === 4 ) {
            this.setState({
                readingScore: 110
            })         
        }
        else if ( correctReading === 5) {
            this.setState({
                readingScore: 120
            })        
        }
        else if ( 6 <= correctReading <= 7) {
            this.setState({
                readingScore: 130
            })
        }
        else if (correctReading === 8) {
            this.setState({
                readingScore: 140
            })        
        }
        else if (correctReading === 9) {
            this.setState({
                readingScore: 150
            }) 
        }
        else if (10 <= correctReading <= 11) {
            this.setState({
                readingScore: 160
            }) 
        }
        else if (12 <=correctReading <= 13) {
            this.setState({
                readingScore: 170
            }) 
        }
        else if (14 <=correctReading <= 15) {
            this.setState({
                readingScore: 180
            }) 
        }
        else if (16 <=correctReading <= 17) {
            this.setState({
                readingScore: 190
            }) 
        }
        else if (18 <=correctReading <= 19) {
            this.setState({
                readingScore: 200
            }) 
        }
        else if (20 <=correctReading <= 21) {
            this.setState({
                readingScore: 210
            }) 
        }
        else if (22 <=correctReading <= 23) {
            this.setState({
                readingScore: 220
            }) 
        }
        else if (24 <=correctReading <= 25) {
            this.setState({
                readingScore: 230
            }) 
        }
        else if (26 <=correctReading <= 27) {
            this.setState({
                readingScore: 240
            }) 
        }
        else if (28 <=correctReading <= 29) {
            this.setState({
                readingScore: 250
            }) 
        }
        else if (30 <=correctReading <= 31) {
            this.setState({
                readingScore: 260
            })  
        }
        else if (correctReading === 32) {
            this.setState({
                readingScore: 270
            })  
        }
        else if (33 <=correctReading <= 34) {
            this.setState({
                readingScore: 280
            })  
        }
        else if (35 <=correctReading <= 36) {
            this.setState({
                readingScore: 290
            })  
        }
        else if (37 <=correctReading <= 38) {
            this.setState({
                readingScore: 300
            })  
        }
        else if (39 <= correctReading <= 41) {
            this.setState({
                readingScore: 310
            })  
        }
        else if ( 42 <= correctReading <= 43) {
            this.setState({
                readingScore: 320
            })  
        }
        else if (44 <= correctReading <= 45) {
            this.setState({
                readingScore: 330
            })  
        }
        else if ( correctReading === 46) {
            this.setState({
                readingScore: 340
            })  
        }
        else if ( correctReading === 47) {
            this.setState({
                readingScore: 350
            })  
        }
        else if (48 <= correctReading <= 49) {
            this.setState({
                readingScore: 360
            })  
        }
        else if ( correctReading === 50) {
            this.setState({
                readingScore: 370
            })  
        }
        else if ( correctReading === 51) {
            this.setState({
                readingScore: 380
            })  
        }
        else if ( correctReading === 52) {
            this.setState({
                readingScore: 400
            })  
        }
        //WRITING SCORE
        if (0 <= correctWriting <=3) {
            this.setState({
                writingScore: 100
            })   
        } 
        else if ( correctWriting === 4 ) {
            this.setState({
                writingScore: 110
            }) 
        }
        else if ( correctWriting === 5) {
            this.setState({
                writingScore: 120
            }) 
        }
        else if ( 6 <= correctWriting <= 7) {
            this.setState({
                writingScore: 130
            }) 
        }
        else if (correctWriting === 8) {
            this.setState({
                writingScore: 140
            }) 
        }
        else if (correctWriting === 9) {
            this.setState({
                writingScore: 150
            }) 
        }
        else if (10 <= correctWriting <= 11) {
            this.setState({
                writingScore: 160
            }) 
        }
        else if (12 <=correctWriting <= 13) {
            this.setState({
                writingScore: 170
            }) 
        }
        else if (14 <=correctWriting <= 16) {
            this.setState({
                writingScore: 180
            }) 
        }
        else if (17 <=correctWriting <= 18) {
            this.setState({
                writingScore: 190
            }) 
        }
        else if (19 <=correctWriting <= 20) {
            this.setState({
                writingScore: 200
            }) 
        }
        else if (21 <=correctWriting <= 22) {
            this.setState({
                writingScore: 210
            }) 
        }
        else if (correctWriting === 23) {
            this.setState({
                writingScore: 220
            }) 
        }
        else if (24 <=correctWriting <= 25) {
            this.setState({
                writingScore: 230
            }) 
        }
        else if (26 <=correctWriting <= 27) {
            this.setState({
                writingScore: 240
            }) 
        }
        else if (28 <=correctWriting <= 29) {
            this.setState({
                writingScore: 250
            }) 
        }
        else if (correctWriting === 30) {
            this.setState({
                writingScore: 260
            }) 
        }
        else if (31 <=correctWriting === 32) {
            this.setState({
                writingScore: 270
            }) 
        }
        else if (correctWriting === 33) {
            this.setState({
                writingScore: 280
            }) 
        }
        else if (34 <=correctWriting <= 35) {
            this.setState({
                writingScore: 290
            }) 
        }
        else if (correctWriting <= 36) {
            this.setState({
                writingScore: 300
            }) 
        }
        else if (37 <= correctWriting <= 38) {
            this.setState({
                writingScore: 310
            }) 
        }
        else if (  correctWriting === 39) {
            this.setState({
                writingScore: 320
            }) 
        }
        else if (correctWriting ===40) {
            this.setState({
                writingScore: 330
            }) 
        }
        else if ( correctWriting === 41) {
            this.setState({
                writingScore: 340
            }) 
        }
        else if ( correctWriting === 42) {
            this.setState({
                writingScore: 360
            }) 
        }
        else if (48 <= correctWriting <= 43) {
            this.setState({
                writingScore: 380
            }) 
        }
        else if ( correctWriting === 44) {
            this.setState({
                writingScore: 400
            }) 
        }

        //MATH
        if (0 <=(correctmathWithCal + correctmathNoCal) <=1) {
            this.setState({
                mathScore: 200
            }) 
        } 
        else if ( (correctmathWithCal + correctmathNoCal) === 2 ) {
            this.setState({
                mathScore: 210
            }) 
        }
        else if ( (correctmathWithCal + correctmathNoCal) === 3) {
            this.setState({
                mathScore: 220
            }) 
        }
        else if ( (correctmathWithCal + correctmathNoCal) === 4) {
            this.setState({
                mathScore: 230
            }) 
        }
        else if ((correctmathWithCal + correctmathNoCal) === 5) {
            this.setState({
                mathScore: 250
            }) 
        }
        else if ((correctmathWithCal + correctmathNoCal) === 6) {
            this.setState({
                mathScore: 270
            }) 
        }
        else if ((correctmathWithCal + correctmathNoCal) === 7) {
            this.setState({
                mathScore: 280
            }) 
        }
        else if ((correctmathWithCal + correctmathNoCal) === 8) {
            this.setState({
                mathScore: 300
            }) 
        }
        else if ((correctmathWithCal + correctmathNoCal) === 9) {
            this.setState({
                mathScore: 310
            }) 
        }
        else if ((correctmathWithCal + correctmathNoCal) === 10) {
            this.setState({
                mathScore: 320
            }) 
        }
        else if  ((correctmathWithCal + correctmathNoCal) === 11) {
            this.setState({
                mathScore: 340
            }) 
        }
        else if  ((correctmathWithCal + correctmathNoCal) === 12) {
            this.setState({
                mathScore: 350
            }) 
        }
        else if  ((correctmathWithCal + correctmathNoCal) === 13) {
            this.setState({
                mathScore: 360
            }) 
        }
        else if  ((correctmathWithCal + correctmathNoCal) === 14) {
            this.setState({
                mathScore: 370
            }) 
        }
        else if  ((correctmathWithCal + correctmathNoCal) === 15) {
            this.setState({
                mathScore: 380
            }) 
        }
        else if  ((correctmathWithCal + correctmathNoCal) === 16) {
            this.setState({
                mathScore: 390
            }) 
        }
        else if  ((correctmathWithCal + correctmathNoCal) === 17) {
            this.setState({
                mathScore: 400
            }) 
        }
        else if  ((correctmathWithCal + correctmathNoCal) === 18) {
            this.setState({
                mathScore: 410
            }) 
        }
        else if  ((correctmathWithCal + correctmathNoCal) === 19) {
            this.setState({
                mathScore: 420
            }) 
        }
        else if  ((correctmathWithCal + correctmathNoCal) === 20) {
            this.setState({
                mathScore: 430
            }) 
        }
        else if  ((correctmathWithCal + correctmathNoCal) === 21) {
            this.setState({
                mathScore: 440
            }) 
        }
        else if  ((correctmathWithCal + correctmathNoCal) === 22) {
            this.setState({
                mathScore: 450
            }) 
        }
        else if  ((correctmathWithCal + correctmathNoCal) === 23) {
            this.setState({
                mathScore: 460
            }) 
        }
        else if  ((correctmathWithCal + correctmathNoCal) === 24) {
            this.setState({
                mathScore: 470
            }) 
        }
        else if  ((correctmathWithCal + correctmathNoCal) === 25) {
            this.setState({
                mathScore: 480
            }) 
        }
        else if  ((correctmathWithCal + correctmathNoCal) === 26) {
            this.setState({
                mathScore: 490
            }) 
        }
        else if  ((correctmathWithCal + correctmathNoCal) === 27) {
            this.setState({
                mathScore: 500
            }) 
        }
        else if  ((correctmathWithCal + correctmathNoCal) === 28) {
            this.setState({
                mathScore: 500
            }) 
        }
        else if  ((correctmathWithCal + correctmathNoCal) === 29) {
            this.setState({
                mathScore: 510
            }) 
        }
        else if  ((correctmathWithCal + correctmathNoCal) === 30) {
            this.setState({
                mathScore: 520
            }) 
        }
        else if  ((correctmathWithCal + correctmathNoCal) === 31) {
            this.setState({
                mathScore: 520
            }) 
        }
        else if  ((correctmathWithCal + correctmathNoCal) === 32) {
            this.setState({
                mathScore: 530
            }) 
        }
        else if  ((correctmathWithCal + correctmathNoCal) === 33) {
            this.setState({
                mathScore: 540
            }) 
        }
        else if  ((correctmathWithCal + correctmathNoCal) === 34) {
            this.setState({
                mathScore: 540
            }) 
        }
        else if  ((correctmathWithCal + correctmathNoCal) === 35) {
            this.setState({
                mathScore: 550
            }) 
        }
        else if  ((correctmathWithCal + correctmathNoCal) === 36) {
            this.setState({
                mathScore: 560
            }) 
        }
        else if  ((correctmathWithCal + correctmathNoCal) === 37) {
            this.setState({
                mathScore: 570
            }) 
        }
        else if  ((correctmathWithCal + correctmathNoCal) === 38) {
            this.setState({
                mathScore: 580
            }) 
        }
        else if  ((correctmathWithCal + correctmathNoCal) === 39) {
            this.setState({
                mathScore: 580
            }) 
        }
        else if  ((correctmathWithCal + correctmathNoCal) === 40) {
            this.setState({
                mathScore: 590
            }) 
        }
        else if  ((correctmathWithCal + correctmathNoCal) === 41) {
            this.setState({
                mathScore: 600
            })
        }
        else if  ((correctmathWithCal + correctmathNoCal) === 42) {
            this.setState({
                mathScore: 610
            }) 
        }
        else if  ((correctmathWithCal + correctmathNoCal) === 43) {
            this.setState({
                mathScore: 610
            }) 
        }
        else if  ((correctmathWithCal + correctmathNoCal) === 44) {
            this.setState({
                mathScore: 620
            }) 
        }
        else if  ((correctmathWithCal + correctmathNoCal) === 45) {
            this.setState({
                mathScore: 630
            }) 
        }
        else if  ((correctmathWithCal + correctmathNoCal) === 46) {
            this.setState({
                mathScore: 640
            }) 
        }
        else if  ((correctmathWithCal + correctmathNoCal) === 47) {
            this.setState({
                mathScore: 650
            }) 
        }
        else if  ((correctmathWithCal + correctmathNoCal) === 48) {
            this.setState({
                mathScore: 660
            }) 
        }
        else if  ((correctmathWithCal + correctmathNoCal) === 49) {
            this.setState({
                mathScore: 670
            }) 
        }
        else if  ((correctmathWithCal + correctmathNoCal) === 50) {
            this.setState({
                mathScore: 680
            }) 
        }
        else if  ((correctmathWithCal + correctmathNoCal) === 51) {
            this.setState({
                mathScore: 690
            }) 
        }
        else if  ((correctmathWithCal + correctmathNoCal) === 52) {
            this.setState({
                mathScore: 700
            }) 
        }
        else if  ((correctmathWithCal + correctmathNoCal) === 53) {
            this.setState({
                mathScore: 710
            }) 
        }
        else if  ((correctmathWithCal + correctmathNoCal) === 54) {
            this.setState({
                mathScore: 730
            }) 
        }
        else if  ((correctmathWithCal + correctmathNoCal) === 55) {
            this.setState({
                mathScore: 750
            }) 
        }
        else if  ((correctmathWithCal + correctmathNoCal) === 56) {
            this.setState({
                mathScore: 770
            }) 
        }
        else if  ((correctmathWithCal + correctmathNoCal) === 57) {
            this.setState({
                mathScore: 790
            }) 
        }
        else if  ((correctmathWithCal + correctmathNoCal) === 58) {
            this.setState({
                mathScore: 800
            }) 
        }

        this.setState({
            isTestSubmitted: true,
            verbal: readingScore + writingScore, 
            total: readingScore + writingScore + mathScore
        });
    }


    calculatePercentageOfAnsweredQuestions() {
        const {sections} = this.state; 
        let numberOfAnsweredQuestions = 0;
            sections.map((section) => {
                section.questions.map((question) => {
                    if (question.selectedChoice != '') {
                        numberOfAnsweredQuestions = numberOfAnsweredQuestions + 1;
                      };
                })
            })
       // sections.map((section) => {
       //     section.questions.map((question) => {
       //         if (question.selectedChoice != '') {
       //           numberOfAnsweredQuestions = numberOfAnsweredQuestions + 1;
       //         };
       //     })
       // });

        let allQuestions = [];
            sections.map((section) => {
                allQuestions = [...allQuestions, ...section.questions]; 
            })
      //  sections.map((section) => {
       //   allQuestions = [...allQuestions, ...section.questions]; 
       // });

        return (numberOfAnsweredQuestions * 100) / allQuestions.length;
    }

    NotAllQuestionsAnswered() {
        /*
         * Check if one of the questions of the current section is not answered
         */ 
        const {subjects} = this.state;
        return subjects.some((subject) => subject.sections.some((section) => section.questions.map((question) => question.selectedChoice === '' ))); 
  //  return sections.some((section) => section.questions.some((question) => question.selectedChoice === ''));
    }

  //  IsTheLastPage() {
    //    const {sections, currentSection} = this.state;
        /*  if id of the current section = the size of the sections then return true */
   //     return ((currentSection === sections.length-1))

    //}    

    IsNotTheFirstPage() {
        const {currentSection} = this.state;
        return ((currentSection !== 0))
    }

    render() {
        const {
            isTestSubmitted,
            verbal,
            readingScore,
            writingScore,
            mathScore, 
            total,
            currentSection, sections, 
        } = this.state;

        /*
         * 
         * check if the current section is the last one
         * 
         */

    //    let allQuestions = [];
      //  sections.map((section) => {
      //    allQuestions = [...allQuestions, ...section.questions]; 
       // });
        //const percentageOfCorrectAnswers = (numberOfCorrectAnswers*100)/sections.questions.length;
        if(isTestSubmitted) {
            
            return (
                <div className="appContainer">
                    <h1>results</h1>
                    <h2>Reading Score: {readingScore}</h2>
                    <h2>Writing and Language Score: {writingScore}</h2>
                    <h2>verbal Score: {verbal}</h2>
                    <h2>Math Score: {mathScore}</h2>
                    <h2>total Score: {total} </h2>

                </div>
            );
        }

        console.log(this.state.correctReading);

        return <div className="appContainer">
            <div className= "header">
            <Timer/>            
            </div>
            <div className="testContainer">

                {this.addPassageOrNot()}

                <div className="questionSection">
                    <div className="article2">
                    {this.renderAllQuestions()}
                    {this.IsNotTheFirstPage() ?  <button className="btn btn-primary"  onClick={() => this.setState({ currentSection: currentSection - 1})}> Back</button> : '' }
                    {this.renderRightButton()}
                    </div>
                </div>
            </div>
            <div className = "progressNum">
                <div>
                    <ProgressNum currentSection={currentSection} sections={sections}/>
                </div>
            </div>
            <div className = "progressbar">
                <div> 
                    <Progress animated color="info" value={this.calculatePercentageOfAnsweredQuestions()} />
                </div>
            </div>
        </div>
        
    }
}

